dependencies:
  - python=3.9
  - pip
  - pip:
    - ..  # d2l
    - mxnet-cu102==1.7.0
    - torch==2.0.0+cu118
    - -f https://download.pytorch.org/whl/torch_stable.html
    - torchvision==0.15.1+cu118
    - -f https://download.pytorch.org/whl/torch_stable.html
    # pip install CUDNN 8.6 required for TF & JAX
    - nvidia-cudnn-cu11==8.6.0.163
    - tensorflow==2.12.0
    - tensorflow-probability==0.19.0
    - tensorflow-datasets==4.8.3
    - "jax[cuda11_pip]==0.4.8"
    - -f https://storage.googleapis.com/jax-releases/jax_cuda_releases.html
    - flax==0.6.8
    - syne-tune[gpsearchers]==0.3.2
variables:
    # Setup CUDNN PATH for Tensorflow
    CUDNN_PATH: "'$(dirname $(python -c \"import nvidia.cudnn;print(nvidia.cudnn.__file__)\"))'"
    LD_LIBRARY_PATH: "'$LD_LIBRARY_PATH:$CONDA_PREFIX/lib/:$CUDNN_PATH/lib'"
